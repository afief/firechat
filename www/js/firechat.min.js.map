{"version":3,"sources":["main.js"],"names":["init","mainApp","Vue","el","data","user","messages","messageText","ready","checkAuth","firebase","auth","onAuthStateChanged","that","database","ref","uid","set","name","displayName","photoURL","signIn","on","row","val","key","push","inIndex","length","once","then","userdata","provider","GoogleAuthProvider","addScope","signInWithPopup","result","token","credential","accessToken","console","log","error","errorCode","code","errorMessage","message","email","warn","this","methods","sendMessage","text","alert","config","apiKey","authDomain","databaseURL","storageBucket","initializeApp","window","addEventListener"],"mappings":"AAUA,QAAAA,QACAC,QAAA,GAAAC,MACAC,GAAA,YACAC,MACAC,QACAC,YACAC,YAAA,IAEAC,MAAA,WAIA,QAAAC,KACAC,SAAAC,OAAAC,mBAAA,SAAAP,GACAA,GACAQ,EAAAR,KAAAA,EAEAK,SAAAI,WAAAC,IAAA,SAAAV,EAAAW,KAAAC,KACAC,KAAAb,EAAAc,YACAC,SAAAf,EAAAe,YAGAC,MAIAX,SAAAI,WAAAC,IAAA,wBAAAO,GAAA,cAAA,SAAAlB,GACA,GAAAmB,GAAAnB,EAAAoB,KACAD,GAAAE,IAAArB,EAAAqB,IACAF,EAAAlB,MAAAe,SAAA,GAAAJ,IAAA,IAEAH,EAAAP,SAAAoB,KAAAH,EACA,IAAAI,GAAAd,EAAAP,SAAAsB,OAAA,CACAlB,UAAAI,WAAAC,IAAA,SAAAQ,EAAAP,KAAAa,KAAA,SAAAC,KAAA,SAAAC,GACAlB,EAAAP,SAAAqB,GAAAtB,KAAA0B,EAAAP,UAKA,QAAAH,KACA,GAAAW,GAAA,GAAAtB,UAAAC,KAAAsB,kBACAD,GAAAE,SAAA,8CAEAxB,SAAAC,OAAAwB,gBAAAH,GAAAF,KAAA,SAAAM,GACA,GAAAC,GAAAD,EAAAE,WAAAC,YACAlC,EAAA+B,EAAA/B,IAEAmC,SAAAC,IAAAJ,EAAAhC,GACAI,MALAC,SAMA,SAAAgC,GACA,GAAAC,GAAAD,EAAAE,KACAC,EAAAH,EAAAI,QACAC,EAAAL,EAAAK,MACAT,EAAAI,EAAAJ,UAEAE,SAAAQ,KAAAL,EAAAE,EAAAE,EAAAT,KA9CA,GAAAzB,GAAAoC,IACAxC,MAiDAyC,SACAC,YAAA,WACA,KAAAF,KAAA1C,aAEAG,SAAAI,WAAAC,IAAA,wBAAAW,MACAV,IAAAiC,KAAA5C,KAAAW,IACAoC,KAAAH,KAAA1C,cAGAiC,QAAAC,IAAA,mBAAAQ,KAAA1C,YAAA,KACA0C,KAAA1C,YAAA,IAEA8C,MAAA,gCAjFA,GAAAC,SACAC,OAAA,0CACAC,WAAA,iCACAC,YAAA,wCACAC,cAAA,6BAEAhD,UAAAiD,cAAAL,QAEAM,OAAAC,iBAAA,OAAA7D,KACA,IAAAC","file":"firechat.min.js","sourcesContent":["var config = {\r\n\tapiKey: \"AIzaSyCkbkamAptA7hwKjTwbudV2c_z3cDEps3s\",\r\n\tauthDomain: \"firechat-948e8.firebaseapp.com\",\r\n\tdatabaseURL: \"https://firechat-948e8.firebaseio.com\",\r\n\tstorageBucket: \"firechat-948e8.appspot.com\",\r\n};\r\nfirebase.initializeApp(config);\r\n\r\nwindow.addEventListener('load', init);\r\nvar mainApp;\r\nfunction init() {\r\n\tmainApp = new Vue({\r\n\t\tel: \"#firechat\",\r\n\t\tdata: {\r\n\t\t\tuser: {},\r\n\t\t\tmessages: [],\r\n\t\t\tmessageText: \"\"\r\n\t\t},\r\n\t\tready: function() {\r\n\t\t\tvar that = this;\r\n\t\t\tcheckAuth();\r\n\r\n\t\t\tfunction checkAuth() {\r\n\t\t\t\tfirebase.auth().onAuthStateChanged(function(user) {\r\n\t\t\t\t\tif (user) {\r\n\t\t\t\t\t\tthat.user = user;\r\n\t\t\t\t\t\t/* save user */\r\n\t\t\t\t\t\tfirebase.database().ref('users/' + user.uid).set({\r\n\t\t\t\t\t\t\tname: user.displayName,\r\n\t\t\t\t\t\t\tphotoURL: user.photoURL\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsignIn();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tfirebase.database().ref('groups/main/messages').on('child_added', function(data) {\r\n\t\t\t\t\tvar row = data.val();\r\n\t\t\t\t\trow.key = data.key;\r\n\t\t\t\t\trow.user = {photoURL: \"\", uid: \"\"};\r\n\r\n\t\t\t\t\tthat.messages.push(row);\r\n\t\t\t\t\tvar inIndex = that.messages.length - 1;\r\n\t\t\t\t\tfirebase.database().ref('users/' + row.uid).once('value').then(function(userdata) {\r\n\t\t\t\t\t\tthat.messages[inIndex].user = userdata.val();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tfunction signIn() {\r\n\t\t\t\tvar provider = new firebase.auth.GoogleAuthProvider();\r\n\t\t\t\tprovider.addScope('https://www.googleapis.com/auth/plus.login');\r\n\r\n\t\t\t\tfirebase.auth().signInWithPopup(provider).then(function(result) {\r\n\t\t\t\t\tvar token = result.credential.accessToken;\r\n\t\t\t\t\tvar user = result.user;\r\n\r\n\t\t\t\t\tconsole.log(token, user);\r\n\t\t\t\t\tcheckAuth();\r\n\t\t\t\t}).catch(function(error) {\r\n\t\t\t\t\tvar errorCode = error.code;\r\n\t\t\t\t\tvar errorMessage = error.message;\r\n\t\t\t\t\tvar email = error.email;\r\n\t\t\t\t\tvar credential = error.credential;\r\n\r\n\t\t\t\t\tconsole.warn(errorCode, errorMessage, email, credential);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tsendMessage: function() {\r\n\t\t\t\tif (this.messageText !== \"\") {\r\n\t\t\t\t\t/* simpan pesan ke database */\r\n\t\t\t\t\tfirebase.database().ref('groups/main/messages').push({\r\n\t\t\t\t\t\tuid: this.user.uid,\r\n\t\t\t\t\t\ttext: this.messageText\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tconsole.log(\"send message : `\" + this.messageText + \"`\");\r\n\t\t\t\t\tthis.messageText = \"\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(\"Pesan tidak boleh kosong\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}"],"sourceRoot":"/source/"}